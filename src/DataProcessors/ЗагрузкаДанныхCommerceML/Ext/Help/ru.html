<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta><link href="v8help://service_book/service_style" type="text/css" rel="stylesheet"></link><meta content="MSHTML 6.00.5730.11" name="GENERATOR"></meta></head><body>
<h1 class="">Обработка "Загрузка данных в формате CommerceML"</h1>
<p>Обработка «Загрузка данных в формате CommerceML» предназначена для просмотра и импорта в 1С:Предприятие электронных документов в соответствии с требованиями второй редакции стандарта CommerceML. Допустимо чтение данных из двух источников - XML-файлов и вложений документов  <a href="Document.ЭлектронноеПисьмо/Help">"Электронное письмо"</a> из базы 1С:Предприятия. <font color="#000000"><font color="#000000">  </font></font></p>
<p>Если выбран режим загрузки <strong><font color="#000040">"Загрузить данные из файла"</font></strong>, то для просмотра электронных документов необходимо выбрать файл или каталог для обработки. Если выбран каталог, то будут прочитаны все файлы, находящиеся в каталоге, имеющие расширение xml. Если выбран режим загрузки <strong><font color="#000040">"Загрузить данные из электронной почты"</font></strong>, то для просмотра электронных документов необходимо установить период отбора документов  <a href="Document.ЭлектронноеПисьмо/Help">"Электронное письмо"</a>. Обработка сканирует все вложения полученных не прочитанных электронных писем из справочника <a href="Catalog.ВложенияЭлектронныхПисем/Help">"Вложения электронных писем"</a> и обрабатывает все файлы вложений с расширением xml.  Для запуска механизмов чтения и обработки данных электронных документов используйте кнопку <strong class="ControlElement">"Загрузить данные"</strong>, находящуюся на командной панели формы. Обратите внимание, что при большом объеме данных в файлах первичная обработка может занять продолжительное время. </p>
<p>Если для загрузки выбран файл XML со структурой не соответствующей стандарту CommerceML он будет проигнорирован системой. </p>
<p>Форма загрузки данных имеет два табличных поля. Верхнее поле – журнал загруженных документов, служит для отображения списка обнаруженных в файлах электронных документов. В графах журнала документов отображается информации шапки документа. Нижнее табличное поле предназначено для отображения табличной части выбранного в журнале документа. В зависимости от вида выбранного документа состав колонок табличной части меняется.</p>
<p>В настоящей версии обмена данными могут быть загружены следующие виды электронных документов:</p>
<ul><li>
<div class=""><strong>Каталог товаров</strong>. В графе «Контрагент» табличного поля журнала документов отображается контрагент-владелец каталога.</div>
</li><li>
<div class=""><strong>Прайс-лист (пакет предложений)</strong>. В графе «Контрагент» табличного поля журнала документов отображается контрагент-владелец прайс-листа.</div>
</li><li>
<div class=""><strong>Документы</strong>. В соответствующих графах табличного поля журнала документов отображаются контрагент-покупатель, организация-заказчик, валюта документа, входящие дата и номер документа.</div></li></ul><p>При чтении данных из файлов проводится поиск элементов справочников в базе данных, соответствующих реквизитам электронных документов. Ячейки журнала документов с реквизитами шапки и табличной части документов, по которым не определены соответствия в базе 1С:Предприятия маркируются цветом.</p>
<p>Для определения соответствий реквизитов электронных документов и элементов справочников в базе 1С:Предприятия необходимо нажатием кнопки <strong><font color="#000040">«Соответствия объектов»</font></strong> вызвать форму определения соответствий.</p>
<p>Для сохранения данных в базе 1С:Предприятия нужно нажать кнопку <strong class="ControlElement">«Сохранить данные»</strong> на командной панели формы. При вызове механизма сохранения данных обрабатываться только документы, маркированные флажками. Для снятия и установки флажков используйте соответствующие кнопки на командной панели. Перед записью на диск проводится тестирование данных электронных документов. В том случае, если какие-либо реквизиты документов не имеют соответствий в виде элементов справочников в базе 1С:Предприятия, сохранение данных не будет произведено. В этом случае необходимо определить соответствия «вручную» в форме определения соответствий.</p>
<h3 class="">Особенности механизма поиска элементов справочников при первичной загрузке данных</h3>
<p>При загрузке данных система проводит поиск элементов справочников. Для элементов справочника <a href="Catalog.Номенклатура/Help">«Номенклатура»</a> при загрузке каталога товаров и пакета предложений в первую очередь проводится поиск по коду номенклатуры контрагента в  регистре сведений <a href="InformationRegister.НоменклатураКонтрагентов/Help">«Номенклатура контрагентов»</a>. Если соответствие не найдено - поиск проводится в справочнике <a href="Catalog.ЕдиницыИзмерения/Help">«Единицы измерения»</a> по реквизиту «Штрихкод». При неудаче, проводится поиск в справочнике <a href="Catalog.Номенклатура/Help">«Номенклатура»</a> по реквизиту «Артикул». Если и в этом случае не удалось определить соответствие, то проводится дополнительный поиск в справочнике <a href="Catalog.Номенклатура/Help">«Номенклатура»</a> по наименованию.</p>
<p>При загрузке <a href="Document.ЗаказПокупателя/Help">заказов покупателя</a> в первую очередь проводится поиск <a href="Catalog.Номенклатура/Help">номенклатуры</a> по идентификаторам поставщика (кодам) в  регистре сведений <a href="InformationRegister.НоменклатураКонтрагентов/Help">«Номенклатура контрагентов»</a>. Если поиск неуспешен – то далее аналогично алгоритму поиска для каталога и прайса.</p>
<p>Соответствия <a href="Catalog.Контрагенты/Help">контрагентов</a> и <a href="Catalog.Организации/Help">организаций</a> определяются по реквизиту «ИНН», а в случае неудачи по наименованию.</p>
<p>Соответствия <a href="Catalog.Валюты/Help">валют</a> и <a href="Catalog.КлассификаторЕдиницИзмерения/Help">единиц измерения</a> определяются по наименованию.</p>
<p>Соответствия <a href="Catalog.ТипыЦенНоменклатурыКонтрагентов/Help">типов цен номенклатуры контрагентов</a> определяются по наименованию, но лишь в том случае если установлено соответствие по контрагенту - владельцу типа цены.</p>
<h3 class="">Форма установки соответствий.</h3>
<p>Форма установки соответствий объектов предназначена для просмотра и определения «вручную» соответствий реквизитов электронных документов и элементов справочников 1С:Предприятия. Соответствия по каждому типу справочника можно просмотреть в табличных частях, переключая страницы на основной панели формы.</p>
<p>Строки с реквизитами, не имеющими соответствий, выделяются цветом. Для просмотра только неопределенных строк используйте кнопку <strong class="ControlElement">«Показать несопоставленные»</strong> командной панели формы. По неопределенным реквизитов могут быть созданы новые элементы справочников в базе 1С:Предприятия. При выборе пункта меню <strong class="ControlElement">«Создать по данным из файла»</strong> будет открыта форма нового элемента справочника. При записи элемента справочника, ссылка на этот элемент будет записана в строку таблицы. При выборе пункта меню <strong class="ControlElement">«Создать все»</strong> будут созданы новые элементы справочников для всех строк активного табличного поля, имеющих неопределенные соответствия. </p>
<p>Для сохранения установленных соответствий в реквизитах электронных документов необходимо нажать кнопку <strong class="ControlElement">«ОК»</strong>.</p></body></html>